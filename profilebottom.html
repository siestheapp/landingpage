<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sies â€“ Profile (Refined)</title>
<link href="https://fonts.googleapis.com/css2?family=Instrument+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#FAF8F6;
  --ink:#1A1A1A;
  --muted:#8A8A8F;
  --accent:#9B7AAD;
  --accent-light:#E8DFF1;
  --stroke:#F0EDE9;
  --card:#FFFFFF;
  --good:#22C55E;
  --personal:#D4A574;
  --shimmer: linear-gradient(120deg, transparent 30%, rgba(255,255,255,0.4) 50%, transparent 70%);
}

*{box-sizing:border-box;margin:0;padding:0}

body{
  font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial;
  background:var(--bg);
  color:var(--ink);
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:0;
}

.phone{
  width:430px;
  height:932px;
  border-radius:55px;
  background:#000;
  padding:2px;
  box-shadow:none;
}

.screen{
  height:100%;
  background:#fff;
  border-radius:53px;
  overflow:hidden;
  position:relative;
  display:flex;
  flex-direction:column;
}

.island{
  position:absolute;
  top:11px;
  left:50%;
  transform:translateX(-50%);
  width:126px;
  height:37px;
  background:#000;
  border-radius:19px;
  z-index:5;
}

.status{
  height:54px;
  margin-top:5px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 30px;
  font-weight:600;
  color:#000;
  font-size:17px;
  letter-spacing:-.02em;
  font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial;
}
.status .right{display:flex;align-items:center;gap:6px}
.status .right img{height:13px;width:auto;display:block}

/* App bar */
.appbar{
  position:sticky; top:0; z-index:4;
  height:44px;
  display:flex; align-items:center; justify-content:center;
  padding:0 20px;
  background:#fff;
}

/* Center title */
.appbar .title{
  font-weight:700; font-size:17px; letter-spacing:-.01em; color:var(--ink);
}

/* Left / Right affordances */
.appbar .left, .appbar .right{
  position:absolute; top:0; height:44px; display:flex; align-items:center;
}
.appbar .left{ left:20px; }
.appbar .right{ right:20px; }

/* Tiny brand "tile" (subtle anchor, not a logo) */
.brand-dot{
  width:22px; height:22px; border-radius:6px;
  display:grid; place-items:center;
}

/* Icon button (settings) */
.icon-btn{
  width:28px; height:28px; border-radius:8px; border:1px solid rgba(0,0,0,.06);
  background:#fff; display:grid; place-items:center; cursor:pointer;
}
.icon-btn svg{ width:16px; height:16px; color:#8A8A8F; }

/* Brand letter styling */
.brand-letter{
  font-weight:700;
  font-size:22px;
  letter-spacing:-.02em;
  background:linear-gradient(180deg,#9B7AAD 0%,#6B4B7A 100%);
  -webkit-background-clip:text;
  background-clip:text;
  -webkit-text-fill-color:transparent;
  font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial;
  filter: drop-shadow(0 2px 4px rgba(0,0,0,0.15)) drop-shadow(0 0 8px rgba(155,122,173,0.3)) drop-shadow(0 0 4px rgba(255,255,255,0.4));
  animation: brandGlimmer 3s ease-in-out infinite;
}

@keyframes brandGlimmer {
  0%, 100% { filter: drop-shadow(0 2px 4px rgba(0,0,0,0.15)) drop-shadow(0 0 8px rgba(155,122,173,0.3)) drop-shadow(0 0 4px rgba(255,255,255,0.4)); }
  50% { filter: drop-shadow(0 2px 4px rgba(0,0,0,0.15)) drop-shadow(0 0 12px rgba(155,122,173,0.5)) drop-shadow(0 0 6px rgba(255,255,255,0.6)); }
}

.content{
  flex:1;
  overflow:auto;
  padding:20px 20px 96px;
  background:
    radial-gradient(260px 140px at 50% -40px, rgba(143,106,174,.06), rgba(143,106,174,0) 65%), var(--bg);
}

.content::-webkit-scrollbar{display:none}

/* Category Carousel - Luxury Style */
.category-carousel{
  margin:4px 0 8px;
  position:relative;
}

.carousel-track{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:8px;
  padding:6px 0;
  position:relative;
  user-select:none;
}

.cat-option{
  font-size:15px;
  font-weight:600;
  color:var(--muted);
  cursor:pointer;
  transition:all 0.25s cubic-bezier(0.4,0,0.2,1);
  padding:6px 12px;
  border-radius:999px;
  border:1px solid rgba(0,0,0,.06);
  background:#fff;
}

.cat-option.active{
  color:#6f5a84;
  background:var(--accent-light);
  border-color:rgba(143,106,174,.25);
}

.cat-option.active::after{ display:none }

@keyframes slideIn{
  from{width:0;opacity:0}
  to{width:32px;opacity:1}
}

.carousel-hint{
  text-align:center;
  font-size:12px;
  color:var(--muted);
  margin-top:4px;
  font-style:italic;
}

/* Fit Profile Card */
.fit-profile-card{
  background:linear-gradient(135deg,#FFFFFF 0%,#FDFBFE 100%);
  border:1px solid var(--stroke);
  border-radius:20px;
  padding:18px;
  margin-bottom:16px;
}

.profile-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:10px;
}

.profile-title{
  font-weight:600;
  font-size:15px;
  color:var(--ink);
}

.profile-strength{
  font-weight:700;
  font-size:16px;
  background:linear-gradient(135deg,#C4A7D8,#9B7AAD);
  -webkit-background-clip:text;
  background-clip:text;
  -webkit-text-fill-color:transparent;
}

.progress-bar{
  height:5px;
  background:var(--accent-light);
  border-radius:10px;
  overflow:hidden;
  position:relative;
}

.progress-fill{
  height:100%;
  background:linear-gradient(90deg,#C4A7D8,#9B7AAD);
  border-radius:10px;
  width:0;
  transition:width 1s cubic-bezier(0.4,0,0.2,1);
  position:relative;
  overflow:hidden;
}

.progress-fill::after{
  content:'';
  position:absolute;
  top:0;
  left:0;
  right:0;
  bottom:0;
  background:var(--shimmer);
  animation:shimmer 2s infinite;
}

@keyframes shimmer{
  0%{transform:translateX(-100%)}
  100%{transform:translateX(100%)}
}

.profile-note{
  font-size:12px;
  color:var(--muted);
  margin-top:8px;
  text-align:center;
}

/* Size Confidence Ring */
.confidence-section{
  background:#FFFFFF;
  border:1px solid var(--stroke);
  border-radius:20px;
  padding:20px;
  margin-bottom:12px;
  text-align:center;
}

.ring-visual{
  width:140px;
  height:140px;
  margin:0 auto 16px;
  position:relative;
}

.ring-visual svg{
  transform:rotate(-90deg);
}

.ring-percent{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:700;
  font-size:36px;
  color:var(--ink);
}

.confidence-text{
  font-size:17px;
  font-weight:600;
  color:var(--ink);
  line-height:1.3;
  margin-bottom:6px;
}

.confidence-text .size-highlight{
  background:linear-gradient(135deg,#C4A7D8,#9B7AAD);
  -webkit-background-clip:text;
  background-clip:text;
  -webkit-text-fill-color:transparent;
}

.confidence-subtext{
  font-size:13px;
  color:var(--muted);
}

/* Measurement Cards */
.measurements{
  display:flex;
  gap:12px;
  overflow-x:auto;
  scroll-snap-type:x mandatory;
  padding-bottom:6px;
  margin-bottom:12px;
  mask-image:linear-gradient(to right, transparent 0, black 24px, black calc(100% - 24px), transparent 100%);
  -webkit-mask-image:linear-gradient(to right, transparent 0, black 24px, black calc(100% - 24px), transparent 100%);
}

.measurements::-webkit-scrollbar{display:none}

.measure-card{
  scroll-snap-align:start;
  flex:0 0 calc(55% - 10px);
  padding:12px 14px;
  background:#FFFFFF;
  border:1px solid var(--stroke);
  border-radius:16px;
  text-align:left;
  transition: transform 0.2s ease;
  cursor:pointer;
}
.measure-card:hover{ transform: translateY(-2px); }

/* Treemap tile hover effect */
.treemap-tile {
  cursor: pointer;
  transition: all 0.2s ease;
}

.treemap-tile:hover {
  transform: scale(1.02);
  z-index: 10;
}

.measure-label{
  font-size:13px;
  text-transform:uppercase;
  letter-spacing:0.05em;
  color:var(--muted);
  font-weight:600;
  margin-bottom:6px;
  font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial;
}

.measure-value{
  font-size:28px;
  font-weight:700;
  color:var(--ink);
  font-variant-numeric: tabular-nums;
  margin-bottom:0;
  font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial;
}

/* Smart Fit Suggestion card */
.fit-insight{ display:flex; gap:12px; align-items:flex-start; }
.fit-insight .thumb{ width:120px; height:160px; border-radius:20px; overflow:hidden; flex:0 0 120px; border:1px solid var(--stroke); background:#f7f5f2; }
.fit-insight .thumb img{ width:100%; height:100%; object-fit:cover; display:block; object-position:center 35%; }
.fit-insight .copy{ flex:1; }
.fit-insight .eyebrow{ margin-bottom:6px; }
.fit-insight .title{ font-size:18px; font-weight:700; margin-bottom:4px; letter-spacing:-.01em; }
.fit-insight .brand{ font-size:14px; color:var(--muted); margin-bottom:10px; }
.fit-insight .rec{ font-size:12px; color:#57575c; display:flex; align-items:center; gap:8px; }
.fit-insight .dotb{ width:8px; height:8px; background:var(--accent); border-radius:999px; opacity:.6; }
.fit-insight .actions{ margin-top:10px; }
.btn-link{ display:inline-flex; align-items:center; gap:6px; font-size:12px; font-weight:700; color:var(--accent); text-decoration:none; padding:6px 10px; border:1px solid rgba(143,106,174,.22); border-radius:999px; background:#fff; }
.insight-card:hover{ transform: translateY(-2px); }

/* Personal Insights - Reimagined */
.insights-card{
  background:linear-gradient(135deg,#FFFDFB 0%,#FFF9F5 100%);
  border:1px solid #F0E6DC;
  border-radius:20px;
  padding:18px;
  margin-bottom:16px;
}

.insights-header{
  display:flex;
  align-items:center;
  gap:8px;
  margin-bottom:14px;
}

.insights-icon{
  width:24px;
  height:24px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:14px;
}

.insights-title{
  font-size:16px;
  font-weight:600;
  color:var(--ink);
}

.insights-subtitle{
  font-size:13px;
  color:var(--muted);
  margin-left:auto;
  font-style:italic;
}

.insight-items{
  display:flex;
  flex-direction:column;
  gap:10px;
}

.insight{
  display:flex;
  align-items:center;
  gap:10px;
  padding:10px 12px;
  background:#FFFFFF;
  border-radius:12px;
  border:1px solid #F5EDE5;
  transition:all 0.2s ease;
}

.insight:hover{
  transform:translateX(2px);
}

.insight-brand{
  font-weight:600;
  font-size:16px;
  color:var(--ink);
  flex:1;
}

.insight-feedback{
  font-size:14px;
  padding:4px 10px;
  border-radius:20px;
  font-weight:500;
}

.insight-feedback.positive{
  background:rgba(34,197,94,0.1);
  color:#16A34A;
}

.insight-feedback.note{
  background:rgba(212,165,116,0.15);
  color:#9B6F3F;
}

/* Smart Recommendations */
.recommendations{
  background:linear-gradient(135deg,#FAFAFF 0%,#FFFFFF 100%);
  border:1px solid var(--stroke);
  border-radius:20px;
  padding:18px;
  margin-top:20px;
}

.rec-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:14px;
}

.rec-title{
  font-size:14px;
  font-weight:600;
  color:var(--ink);
}

.rec-swipe{
  font-size:11px;
  color:var(--muted);
  font-style:italic;
}

/* Bottom Navigation */

.tabs{
  position:absolute;
  left:0;
  right:0;
  bottom:0;
  height:83px;
  background:#fff;
  border-top:1px solid rgba(0,0,0,.06);
  display:flex;
  justify-content:space-around;
  align-items:flex-start;
  padding-top:8px;
  padding-bottom:34px;
}

.tab{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:6px;
  text-decoration:none;
  color:#8e8e93;
  font-size:11px;
  font-weight:500;
}

.tab.active{color:#8F6AAE}

.ico{width:28px;height:28px}

.labels{ position:absolute; inset:0; pointer-events:none; }
.label{
  position:absolute;
  font:600 13.5px/1.2 Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  color:var(--ink);
  opacity:.98;
}
.label span{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.label .brand, .label .size{
  padding:6px 8px;
  border-radius:8px;
  backdrop-filter: blur(2px);
  background: rgba(255,255,255,0.55);
}
.label .brand{ position:absolute; left:8px; top:8px; font-weight:700; }
.label .size{ position:absolute; right:8px; bottom:8px; font-weight:800; }
</style>
</head>
<body>
  <div class="phone">
    <div class="screen">
      <div class="island"></div>
      <div class="status"><div>9:41</div><div class="right"><img src="../Cellular Connection.svg" alt="cell"/><img src="../Wifi.svg" alt="wifi"/><img src="../Battery.svg" alt="battery"/></div></div>
      <div class="appbar">
        <div class="left"><div class="brand-dot"><span class="brand-letter">S</span></div></div>
        <div class="title">Fit Profile</div>
        <div class="right">
          <button class="icon-btn" aria-label="Settings">
            <!-- gear icon -->
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                 stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <path d="M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Z"/>
              <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06A1.65 1.65 0 0 0 15 19.4a1.65 1.65 0 0 0-1 .6 1.65 1.65 0 0 0-.33 1.82l.03.08a2 2 0 1 1-3.4 0l.03-.08A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.6 15a1.65 1.65 0 0 0-.6-1 1.65 1.65 0 0 0-1.82-.33l-.08.03a2 2 0 1 1 0-3.4l.08.03A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.6c.36 0 .71-.12 1-.6a1.65 1.65 0 0 0 .33-1.82l-.03-.08a2 2 0 1 1 3.4 0l-.03.08c-.15.37-.12.78.33 1.82.29.48.64.6 1 .6a1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9c0 .36.12.71.6 1a1.65 1.65 0 0 0 1.82.33l.08-.03a2 2 0 1 1 0 3.4l-.08-.03a1.65 1.65 0 0 0-1.82.33c-.48.29-.6.64-.6 1Z"/>
            </svg>
          </button>
        </div>
      </div>
      <div class="content">

        <!-- Fit Profile Strength (copied style from profile-screen.html) -->
        <div class="progress-card" style="background: linear-gradient(135deg, #F0F9FF 0%, #FFFFFF 100%); border: 1px solid #E0F2FE; border-radius: 16px; padding: 16px; margin-bottom: 8px;">
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
            <span style="font-weight: 700; color: var(--ink); font-size: 15px;">Profile Strength</span>
            <span style="font-weight: 700; color: var(--accent); font-size: 15px;">85%</span>
          </div>
          <div style="height: 6px; background: #E5E7EB; border-radius: 3px; overflow: hidden;">
            <div id="profileBar" style="height: 100%; width: 0%; background: linear-gradient(90deg, var(--accent), #A78BFA); border-radius: 3px; transition: width 0.8s ease; animation: progressLoad 1.2s ease-out;"></div>
          </div>
          <div style="font-size: 12px; color: var(--muted); margin-top: 6px;">Add 2 more items to unlock premium fit insights</div>
        </div>

        <!-- Elegant Category Carousel -->
        <div class="category-carousel">
          <div class="carousel-track" id="categoryTrack">
            <div class="cat-option active" data-cat="all">All</div>
            <div class="cat-option" data-cat="tops">Tops</div>
            <div class="cat-option" data-cat="dresses">Dresses</div>
            <div class="cat-option" data-cat="bottoms">Pants</div>
          </div>
        </div>

        <!-- Size Mosaic (replaces the confidence card) -->
        <div class="confidence-section mosaic-card" style="padding:16px;background:#FFF;border-radius:18px;">
          <div id="mosaic" style="position:relative;width:100%;height:300px;border-radius:0;overflow:hidden;">
            <canvas id="gl" style="display:block;width:100%;height:100%;border-radius:0;"></canvas>
            <div id="labels" class="labels"></div>
          </div>
          <div class="confidence-subtext" style="margin-top:8px">
            A mosaic of your closet. Brand â†– size â†˜.
          </div>
        </div>

        <!-- Measurements -->
        <div class="measurements">
          <div class="measure-card">
            <div class="measure-label">Bust Range</div>
            <div class="measure-value">31â€“33.5"</div>
          </div>
          <div class="measure-card">
            <div class="measure-label">Waist Range</div>
            <div class="measure-value">25.5â€“26.5"</div>
          </div>
          <div class="measure-card">
            <div class="measure-label">Hip Range</div>
            <div class="measure-value">34.5â€“35.5"</div>
          </div>
        </div>

        <!-- Personal Insights (Reimagined Quick Guidance) -->
        <div class="card insight-card" style="margin:14px 0 16px; padding: 20px 24px; background: linear-gradient(135deg, #F9F8FF 0%, #FFFFFF 100%); border: 1px solid rgba(143,106,174,.12); transition: transform 0.2s ease;">
          <a class="fit-insight" href="https://www.anthropologie.com/shop/hutch-corene-strapless-floral-tulle-a-line-midi-dress2?category=clothes-top-rated&color=038&type=STANDARD&quantity=1" target="_blank" rel="noreferrer" style="text-decoration:none; color:inherit; display:flex; gap:20px; align-items:flex-start;">
            <div class="thumb" style="border: 2px solid var(--accent);">
              <img alt="Hutch Corene Strapless Floral Tulle A-Line Midi Dress" src="https://images.urbndata.com/is/image/Anthropologie/98281447_038_b?$a15-pdp-detail-shot$&fit=constrain&fmt=webp&qlt=80&wid=600"/>
            </div>
            <div class="copy">
              <div class="eyebrow" style="color: var(--accent); font-weight: 700; font-size: 14px; margin-bottom: 10px;">Smart Fit Suggestion</div>
              <div class="product-name" style="font-size: 20px; font-weight: 700; color: var(--ink); margin-bottom: 8px; line-height: 1.2;">Strapless Mini Dress (S)</div>
              <div class="brand" style="margin-bottom: 10px; font-size: 16px; font-weight: 500; color: var(--ink);">Anthropologie</div>
              <div class="tap-to-view" style="font-size: 16px; color: var(--accent); font-weight: 700; text-decoration: underline; text-underline-offset: 3px; text-decoration-thickness: 2px; letter-spacing: .01em; display: inline-block;">Explore the fit</div>
            </div>
          </a>
        </div>

        <div class="insights-card">
          <div class="insights-header">
            <div class="insights-icon">âœ…</div>
            <div class="insights-title">Your Personal Insights</div>
            <div class="insights-subtitle">from your try-ons</div>
          </div>
          <div class="insight-items">
            <div class="insight">
              <span class="insight-brand">Anthropologie S</span>
              <span class="insight-feedback positive">Perfect fit</span>
            </div>
            <div class="insight">
              <span class="insight-brand">Favorite Daughter S</span>
              <span class="insight-feedback positive">Love it</span>
            </div>
            <div class="insight">
              <span class="insight-brand">Zara S</span>
              <span class="insight-feedback note">Bust tight</span>
            </div>
            <div class="insight">
              <span class="insight-brand">H&M S</span>
              <span class="insight-feedback note">Too short</span>
            </div>
          </div>
        </div>



      </div>

      <div class="tabs">
        <a class="tab" href="#"><svg class="ico" viewBox="0 0 256 256" aria-hidden="true"><path fill="currentColor" d="M241,150.65s0,0,0-.05a51.33,51.33,0,0,0-2.53-5.9L196.93,50.18a12,12,0,0,0-2.5-3.65,36,36,0,0,0-50.92,0A12,12,0,0,0,140,55V76H116V55a12,12,0,0,0-3.51-8.48,36,36,0,0,0-50.92,0,12,12,0,0,0-2.5,3.65L17.53,144.7A51.33,51.33,0,0,0,15,150.6s0,0,0,.05A52,52,0,1,0,116,168V100h24v68a52,52,0,1,0,101-17.35ZM80,62.28a12,12,0,0,1,12-1.22v63.15a51.9,51.9,0,0,0-35.9-7.62ZM64,196a28,28,0,1,1,28-28A28,28,0,0,1,64,196ZM164,61.06a12.06,12.06,0,0,1,12,1.22l23.87,54.31a51.9,51.9,0,0,0-35.9,7.62ZM192,196a28,28,0,1,1,28-28A28,28,0,0,1,192,196Z"/></svg><span>Find</span></a>
        <a class="tab" href="#"><svg class="ico" viewBox="0 0 256 256" aria-hidden="true"><path fill="currentColor" d="M225.24,174.74a12,12,0,0,1-1.58,16.89C205.49,206.71,189.06,212,174.15,212c-19.76,0-36.86-9.29-51.88-17.44-25.06-13.62-44.86-24.37-74.61.3a12,12,0,1,1-15.32-18.48c42.25-35,75-17.23,101.39-2.92,25.06,13.61,44.86,24.37,74.61-.3A12,12,0,0,1,225.24,174.74Zm-16.9-57.59c-29.75,24.67-49.55,13.91-74.61.3-26.35-14.3-59.14-32.11-101.39,2.92a12,12,0,0,0,15.32,18.48c29.75-24.67,49.55-13.92,74.61-.3,15,8.15,32.12,17.44,51.88,17.44,14.91,0,31.34-5.29,49.51-20.36a12,12,0,0,0-15.32-18.48ZM47.66,82.84c29.75-24.67,49.55-13.92,74.61-.3,15,8.15,32.12,17.44,51.88,17.44,14.91,0,31.34-5.29,49.51-20.36a12,12,0,0,0-15.32-18.48c-29.75,24.67-49.55,13.92-74.61.3-26.35-14.3-59.14-32.11-101.39,2.93A12,12,0,1,0,47.66,82.84Z"/></svg><span>Feed</span></a>
        <a class="tab" href="#"><svg class="ico" viewBox="0 0 256 256" aria-hidden="true"><path fill="currentColor" d="M244,168,148,96l19.2-14.4A12,12,0,0,0,172,72a44,44,0,0,0-87.66-5.48,12,12,0,1,0,23.82,3,20,20,0,0,1,39.09-2.92L121,86.24c-.15.1-.29.21-.43.32L12,168a20,20,0,0,0,12,36H232a20,20,0,0,0,12-36ZM36,180l92-69,92,69Z"/></svg><span>Closet</span></a>
        <a class="tab active" href="#"><svg class="ico" viewBox="0 0 256 256" aria-hidden="true"><path fill="currentColor" d="M234.38,210a123.36,123.36,0,0,0-60.78-53.23,76,76,0,1,0-91.2,0A123.36,123.36,0,0,0,21.62,210a12,12,0,1,0,20.77,12c18.12-31.32,50.12-50,85.61-50s67.49,18.69,85.61,50a12,12,0,0,0,20.77-12ZM76,96a52,52,0,1,1,52,52A52.06,52.06,0,0,1,76,96Z"/></svg><span>Profile</span></a>
      </div>
    </div>
  </div>

<script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
<script type="module">
  import * as THREE from 'https://unpkg.com/three@0.160.0/build/three.module.js';

  // ---- Your closet items (brand â†™ / size â†˜) ----
  const ITEMS = [
    {cat:'tops',    brand:'COS',              size:'XS'},
    {cat:'tops',    brand:'Sies Marjan',      size:'0 / XS'},
    {cat:'tops',    brand:'ALFIE',            size:'S'},
    {cat:'tops',    brand:'RÃ³he',             size:'EU 32'},
    {cat:'bottoms', brand:'AYR',              size:'26S'},
    {cat:'bottoms', brand:'Zara',             size:'M'},
    {cat:'dresses', brand:'Georgia Hardinge', size:'UK 8'},
    {cat:'dresses', brand:'Alexis',           size:'S'}
  ];

  // active category filter (null = all)
  let activeCat = null; // null = all

  // ---- Category brand hues (Coolors palette) ----
  const CATEGORY_HUES = {
    tops:    '#9B7AAD', // African Violet
    dresses: '#5A9B8A', // Teal green
    bottoms: '#0D3B66', // Yale Blue (we'll soften it)
    all:     '#CFC7E8'  // fallback
  };

  // helper: hex -> THREE.Color
  function colorHex(hex){ return new THREE.Color(hex); }

  // pastel-ize: gently desaturate and lift lightness
  function softenColor(hex){
    const c = colorHex(hex);
    const hsl = { h:0, s:0, l:0 };
    c.getHSL(hsl);

    const lift = hsl.l < 0.45 ? 0.22 : 0.12;  // smaller lift
    hsl.s *= 0.75;                            // leave some saturation
    hsl.l = Math.min(0.90, Math.max(0.76, hsl.l + lift)); // cap at 0.90, floor 0.76

    // Special handling for green hues - reduce white tint
    if (hsl.h >= 90 && hsl.h <= 150) { // green range
      hsl.s *= 1.4; // boost saturation much more
      hsl.l = Math.max(0.60, hsl.l - 0.20); // keep it much darker
    }
    
    // Special handling for mint green (#D2F1E4) - make it much more visible
    if (hsl.h >= 140 && hsl.h <= 180) { // mint/teal range
      hsl.s *= 1.6; // boost saturation significantly
      hsl.l = Math.max(0.55, hsl.l - 0.25); // keep it much darker
    }

    c.setHSL(hsl.h, hsl.s, hsl.l);
    return c;
  }

  // subtle per-tile variation inside the same hue family
  function variantColor(hex, seed){
    const c = softenColor(hex);          // start pastel
    const wobble = (Math.sin(seed * 12.9898) * 43758.5453) % 1;
    const amt = (wobble - 0.5) * 0.05;   // Â±5% only
    c.offsetHSL(0, 0, amt);
    return c;
  }

  // ---- Text measurement helper ----
  const measure = (() => {
    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    function width(text, weight = 600, size = 12.5){
      ctx.font = `${weight} ${size}px Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif`;
      return ctx.measureText(text).width;
    }
    return { width };
  })();

  // ---- Treemap layout (area ~= min box needed for text) ----
  function computeMinBox(item){
    const line = 14; // approx line-height in px at 12.5
    const padX = 16; // left+right inner padding for label
    const padY = 10; // top+bottom
    const gap = 10;  // space between brand and size on one line

    const brandW = measure.width(item.brand, 600, 12.5);
    const sizeW  = measure.width(item.size, 800, 12.5);

    // Option A: single line (brand .... size)
    const w1 = brandW + gap + sizeW + padX;
    const h1 = line + padY;

    // Option B: two lines (brand on top, size bottom-right)
    const w2 = Math.max(brandW, sizeW) + padX;
    const h2 = (line * 2) + (padY + 4);

    // Prefer the option closer to square tiles
    const a1 = w1 * h1;
    const a2 = w2 * h2;
    const useA = Math.abs((w1/h1) - 1) < Math.abs((w2/h2) - 1) ? true : a1 <= a2;

    return { w: useA ? w1 : w2, h: useA ? h1 : h2, brandW, sizeW };
  }

  const layoutTreemap = (W,H) => {
    const data = activeCat ? ITEMS.filter(d => d.cat === activeCat) : ITEMS;
    // Nudge very tall/narrow tiles like Alexis to reserve a minimum width
    // by inflating their value a bit if the text would squeeze.
    const enriched = data.map(d => {
      const box = computeMinBox(d);
      const area = box.w * box.h;
      // Slight bias so longer brands get a bit more space
      let bias = 1 + Math.min(0.5, d.brand.length * 0.02);
      if(d.brand === 'Alexis' && d.size === 'S') bias *= 1.6; // prevent over-skinny
      return { ...d, value: area * bias };
    });

    const root = d3.hierarchy({ children: enriched }).sum(d => d.value);
    d3.treemap()
      .size([W, H])
      .paddingInner(4)
      .round(true)
      .tile(d3.treemapSquarify.ratio(1.1))(root);

    return root.leaves().map(l => ({
      x:l.x0, y:l.y0, w:l.x1-l.x0, h:l.y1-l.y0,
      cat:l.data.cat, brand:l.data.brand, size:l.data.size
    }));
  };

  // ---- Shaders (glossy/iridescent look) ----
  const vtx=`varying vec2 vUv;void main(){vUv=uv;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}`;
  const frg = `
precision highp float;

uniform vec3  uBase;
uniform vec2  uSize;   // tile size in pixels
uniform float uTime;
uniform float uBoost;  // active category boost
uniform vec2  uLightCorner;   // 0..1 UV where the "lamp" lives (e.g., top-left)
uniform float uCornerStrength;

varying vec2 vUv;

// noise-ish sparkle
float hash(vec2 p){ return fract(sin(dot(p, vec2(127.1,311.7))) * 43758.5453); }

// distance to the nearest edge in UV (0..1); 0 at edge, 0.5 at center on small side
float edgeDist(vec2 uv){
  float d = min(min(uv.x, 1.0-uv.x), min(uv.y, 1.0-uv.y));
  return d;
}

void main(){
  float t = uTime * 0.15;

  // soft moving glimmer lobes
  float g1 = smoothstep(1.0, 0.0, distance(vUv, vec2(0.28, 0.26) + 0.03*vec2(sin(t), cos(t))));
  float g2 = smoothstep(1.05, 0.0, distance(vUv, vec2(0.72, 0.22) + 0.02*vec2(cos(t*0.8), sin(t*0.6))));
  float g3 = smoothstep(1.1, 0.0,  distance(vUv, vec2(0.58, 0.78) + 0.025*vec2(sin(t*0.7), cos(t*0.9))));

  vec3 col = mix(uBase, vec3(1.0), 0.08); // tiny lift only

  // corner hotspot + directional falloff (feels like a real light)
  vec2 L = uLightCorner;                 // usually vec2(0.06, 0.10) for top-left
  float r   = distance(vUv, L);          // distance from corner
  float core = smoothstep(0.48, 0.12, r);        // smaller bright zone

  // give more lift along the light direction (down-right from the corner)
  vec2 dirVec = normalize(vec2(1.0, 1.15));                // diagonal flow
  float dir   = clamp(dot(normalize(vUv - L), dirVec), 0.0, 1.0);

  // white lift mixes toward 1.0, scaled by selection boost and a strength knob
  float lift = (0.10 + 0.08 * dir) * core * uBoost * uCornerStrength;
  
  // Reduce white lift for green hues to prevent washout
  float greenness = smoothstep(0.1, 0.6, col.g) * smoothstep(0.9, 0.2, col.r) * smoothstep(0.9, 0.2, col.b);
  lift *= (1.0 - 0.95 * greenness); // 95% less white lift for green tiles
  
  col = mix(col, vec3(1.0), lift);
  col *= mix(0.97, 1.05, vUv.y);            // glass vertical lift

  // keep your glimmer lobes here (g1/g2/g3) but scale a touch with uBoost:
  col += uBase * vec3(1.02,1.01,1.03) * 0.10 * uBoost * g1;
  col += uBase * vec3(1.03,1.02,1.00) * 0.12 * uBoost * g2;
  col += vec3(1.0) * 0.06 * uBoost * g3;

  // inner bevel / edge shading (keeps corners sharp but adds depth)
  float e = edgeDist(vUv);                 // ~0 at edges, ~0.5 near center
  float innerShadow = smoothstep(0.06, 0.0, e);   // darken very close to edge
  col *= (1.0 - 0.06 * innerShadow);  // slightly stronger inner shadow

  // rim lightâ€”slightly brighter on top/left edges like a glazed tile
  float rim = 0.0;
  rim += smoothstep(0.018, 0.0, vUv.x) * 0.03;
  rim += smoothstep(0.018, 0.0, 1.0 - vUv.y) * 0.03;
  col += rim;

  // micro sparkle (resolution aware)
  float sp = smoothstep(0.996, 1.0, hash(vUv * uSize + t));
  col += sp * 0.06;

  // subtle center vignette so tiles feel slightly domed
  float vig = smoothstep(0.8, 0.2, distance(vUv, vec2(0.5)));
  col *= mix(1.0, 0.985, vig);

  gl_FragColor = vec4(col, 1.0);
}
`;

  // ---- Render (responsive; keeps labels aligned) ----
  const mount = document.getElementById('mosaic');
  const canvas = document.getElementById('gl');
  const labelsLayer = document.getElementById('labels');
  const renderer = new THREE.WebGLRenderer({canvas, alpha:true, antialias:true});
  const scene = new THREE.Scene();
  const camera = new THREE.OrthographicCamera(0, 1, 1, 0, -10, 10);
  const materials = [];
  const GAP = 2; // px total gap per tile (looks like grout)

  function makeTileMaterial(tile, size, activeCategory){
    const catHue = CATEGORY_HUES[tile.cat] || CATEGORY_HUES.all;
    const base   = variantColor(catHue, (tile.x+tile.y+tile.w+tile.h) * 0.001);
    const allView = (!activeCategory || activeCategory === 'all');
    const boost  = allView ? 1.0 : (activeCategory === tile.cat ? 1.0 : 0.65); // was 0.7

    return new THREE.ShaderMaterial({
      transparent: true,
      vertexShader: vtx,
      fragmentShader: frg,
      uniforms: {
        uBase:  { value: base },
        uSize:  { value: new THREE.Vector2(size.w, size.h) },
        uTime:  { value: 0.0 },
        uBoost: { value: boost },
        uLightCorner: { value: new THREE.Vector2(0.06, 0.10) },
        uCornerStrength: { value: 0.20 }
      }
    });
  }

  function draw(){
    const W = mount.clientWidth, H = mount.clientHeight;
    renderer.setPixelRatio(Math.min(2, window.devicePixelRatio||1));
    renderer.setSize(W,H,false);
    camera.left=0; camera.right=W; camera.top=H; camera.bottom=0; camera.updateProjectionMatrix();

    const tiles = layoutTreemap(W,H);
    while(scene.children.length) scene.remove(scene.children[0]);
    labelsLayer.innerHTML='';
    materials.length = 0; // Clear materials array

    tiles.forEach(t=>{
      const mat = makeTileMaterial(t, t, window.ACTIVE_CATEGORY || 'all');
      const w = Math.max(1, t.w - GAP);
      const h = Math.max(1, t.h - GAP);
      const geom = new THREE.PlaneGeometry(w, h);
      const mesh = new THREE.Mesh(geom, mat);
      mesh.position.set(t.x + t.w/2, H-(t.y + t.h/2), 0);
      scene.add(mesh);
      materials.push(mat);

      // Labels: brand top-left, size bottom-right; larger base font, shrink if needed
      const div=document.createElement('div');
      div.className='label';
      div.style.left=(t.x)+'px';
      div.style.top=(t.y)+'px';
      div.style.width=(t.w)+'px';
      div.style.height=(t.h)+'px';

      let baseSize = 13.5;
      let brandW = measure.width(t.brand, 700, baseSize);
      let sizeW  = measure.width(t.size, 800, baseSize);
      const availableW = Math.max(20, t.w - 16);
      while(baseSize > 10 && (brandW > availableW || sizeW > availableW)){
        baseSize -= 0.5;
        brandW = measure.width(t.brand, 700, baseSize);
        sizeW  = measure.width(t.size, 800, baseSize);
      }
      div.style.fontSize = baseSize + 'px';
      div.innerHTML = `<span class="brand">${t.brand}</span><span class="size">${t.size}</span>`;
      div.style.cursor = 'pointer';
      div.style.position = 'absolute';
      div.style.pointerEvents = 'auto';
      
      // Add hover effect
      div.addEventListener('mouseenter', () => {
        div.style.transform = 'scale(1.02)';
        div.style.zIndex = '10';
        div.style.transition = 'all 0.2s ease';
        div.style.backgroundColor = 'rgba(255,255,255,0.1)';
        div.style.borderRadius = '8px';
      });
      
      div.addEventListener('mouseleave', () => {
        div.style.transform = 'scale(1)';
        div.style.zIndex = '1';
        div.style.backgroundColor = 'transparent';
      });
      
      labelsLayer.appendChild(div);
    });

    renderer.render(scene,camera);
  }

  // animate sheen
  function tick(){
    materials.forEach(m => { m.uniforms.uTime.value = performance.now() * 0.001; });
    renderer.render(scene,camera);
    requestAnimationFrame(tick);
  }
  function init(){ draw(); requestAnimationFrame(tick); }

  // category filter interactions
  const filterEls = Array.from(document.querySelectorAll('.cat-option'));
  filterEls.forEach((el, idx) => {
    el.addEventListener('click', () => {
      const cat = el.dataset.cat;
      filterEls.forEach(e => e.classList.toggle('active', e === el));
      setActiveCategory(cat);
    });
  });

  function setActiveCategory(cat){
    window.ACTIVE_CATEGORY = cat;
    activeCat = (cat === 'all') ? null : cat;
    draw(); // Redraw the treemap with filtered data
  }

  if(document.fonts && document.fonts.ready){ document.fonts.ready.then(init); } else { init(); }
  new ResizeObserver(draw).observe(mount);
</script>

<script>
// Animate profile strength bar
setTimeout(() => {
  const el = document.getElementById('profileBar');
  if(el) el.style.width = '85%';
}, 100);

// Animate confidence ring
setTimeout(() => {
  const ring = document.getElementById('confidenceRing');
  const percent = 0.84;
  const circumference = 2 * Math.PI * 60;
  const offset = circumference * (1 - percent);
  ring.style.transition = 'stroke-dashoffset 1s cubic-bezier(0.4,0,0.2,1)';
  ring.style.strokeDashoffset = offset;
}, 200);

// Category carousel interaction
const categories = document.querySelectorAll('.cat-option');
let startX = null;
let currentX = null;
let currentIndex = 1; // Start with Dresses

const categoryTrack = document.getElementById('categoryTrack');

categoryTrack.addEventListener('touchstart', (e) => {
  startX = e.touches[0].clientX;
}, { passive: true });

categoryTrack.addEventListener('touchmove', (e) => {
  if (!startX) return;
  currentX = e.touches[0].clientX;
}, { passive: true });

categoryTrack.addEventListener('touchend', () => {
  if (!startX || !currentX) return;
  
  const diff = startX - currentX;
  if (Math.abs(diff) > 50) {
    if (diff > 0 && currentIndex < categories.length - 1) {
      currentIndex++;
    } else if (diff < 0 && currentIndex > 0) {
      currentIndex--;
    }
    updateCategory();
  }
  
  startX = null;
  currentX = null;
});

// Click to select category
categories.forEach((cat, index) => {
  cat.addEventListener('click', () => {
    currentIndex = index;
    updateCategory();
  });
});

function updateCategory() {
  categories.forEach((cat, index) => {
    cat.classList.toggle('active', index === currentIndex);
  });
}
</script>
</body>
</html>
</html>